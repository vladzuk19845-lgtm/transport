performance.mark("js-parse-end:67894-3c69c611a4c4556a.js");
"use strict";(globalThis.webpackChunk_github_ui_github_ui=globalThis.webpackChunk_github_ui_github_ui||[]).push([["67894"],{37013(e,l,t){t.r(l),t.d(l,{FileResultRow:()=>I,default:()=>k});var s=t(74848),r=t(68216),i=t(75474),a=t(77277),n=t(65513),o=t(70516),u=t(3783),c=t(32764),d=t(91374),f=t(98632),m=t(1703),h=t(29941),_=t(38621),g=t(45800),x=t(59134),p=t(18990),v=t(83223),R=t(66818),b=t(7478),E=t(94709),F=t(10095),L=t(91385),y=t(96540),N=t(34604),C=t(57790),j=t(47698),A=t(58690),S=t(34164);let w={excludeDirectories:!1,excludeSeeAllResults:!1};function k({actionListClassName:e,additionalResults:l,commitOid:t,config:d=w,findFileWorkerPath:_,getItemUrl:b,onRenderRow:F,onItemSelected:L,searchBoxRef:k,className:I,sx:q}){var $;let z,{excludeDirectories:H,excludeSeeAllResults:M}=d,{query:O,setQuery:Z}=(0,r.JS)(),B=(0,o.t)(),Y=y.useRef(null),G=k??Y,[K,V]=y.useState(O.length>0),[P,U]=y.useState(!!O),{list:X,directories:J,loading:W,error:Q}=(0,A.o)(t,K,!!H),ee=(0,y.useMemo)(()=>new Set(J),[J]),{path:el}=(0,i.eu)(),{getUrl:et}=(0,n.Z)(),{queryText:es,queryLine:er}=(z=($=($=O).replaceAll(" ","")).indexOf(":"))>=0?{queryText:$.substring(0,z),queryLine:parseInt($.substring(z+1),10)}:{queryText:$,queryLine:void 0},ei=(0,y.useDeferredValue)(es),{matches:ea,clearMatches:en}=function(e,l,t,s){let[r,i]=y.useState(),n=y.useRef(""),o=y.useRef(null),{sendStats:u}=(0,a.T)(),c=y.useRef(!1),d=y.useRef(""),f=(0,y.useEffectEvent)(()=>{let e=new N.z(t,C.j);e.onmessage=({data:e})=>{c.current=!1,(0,y.startTransition)(()=>{i(e.list)}),n.current=e.query,e.startTime&&e.query===d.current&&u("repository.find-file",{"find-file-base-count":e.baseCount,"find-file-results-count":e.list.length,"find-file-duration-ms":performance.now()-e.startTime})},o.current=e}),m=(0,y.useEffectEvent)((e,l)=>{let t=n.current&&l.startsWith(n.current);c.current=!0,d.current=l,o.current?.postMessage({baseList:t&&r||e,query:l,startTime:performance.now()})});return y.useEffect(()=>{if(s)return f(),function(){o.current?.terminate()}},[s]),y.useEffect(()=>{e.length&&l&&(c.current&&(o.current?.terminate(),f()),m(e,l))},[e,l]),{matches:r,clearMatches:(0,y.useCallback)(()=>i(void 0),[])}}((0,y.useMemo)(()=>[...X,...l??[]].sort(),[l,X]),ei,_,K),{sendRepoClickEvent:eo}=(0,a.T)(),eu=(0,m.Z)(),[ec,ed]=y.useState(0),[ef,em]=y.useState(()=>(0,j.q)()),eh=y.useRef(null),e_=y.useRef(null),eg="file-results-list",{sendRepoKeyDownEvent:ex}=(0,a.T)(),{screenSize:ep}=(0,f.lm)(),ev=d.enableOverlay??ep>=f.Gy.large,eR=y.useCallback(e=>{eo("FILE_TREE.SEARCH_RESULT_CLICK"),L?.(e),U(!1)},[eo,L]),eb=(e,l,t)=>b?b(e,l,t):et({path:e,action:l?"tree":"blob",hash:t}),{containerRef:eE}=(0,g.G)({bindKeys:h.z0.ArrowVertical|h.z0.HomeAndEnd,focusInStrategy:"previous"},[W,Q]);y.useEffect(()=>{O||U(!1)},[O]),y.useEffect(()=>{document.activeElement!==G.current&&ev&&U(!1)},[el,G,ev]);let eF=(0,y.useMemo)(()=>ea?.slice(0,40)??[],[ea]),eL=ea&&ea.length>eF.length,ey=(0,s.jsx)("div",{className:(0,S.$)("FileResultsList-module__Box__vckZ256",{"FileResultsList-module__OverlayEnabled__YxF1DLE":ev}),children:Q?(0,s.jsx)(x.A,{variant:"danger",className:"m-3",children:"Failed to search"}):(0,s.jsxs)(p.l,{ref:eE,className:(0,S.$)(e,"FileResultsList-module__ActionList__HH95OJQ",{"FileResultsList-module__ActionList_Overlay__YavkN7W":ev}),role:"listbox",children:[!W&&eF.map((e,l)=>{let t=ee.has(e),r=eb(e,t,er?`L${er}`:"");return(0,s.jsx)(D,{active:e===el,index:l,focused:ef&&ec===l,match:e,onRender:F,query:ei,onClick:eR,isDirectory:t,to:r,useOverlay:ev,listRef:eE},e)}),(0,s.jsxs)("div",{className:"m-3 text-center",children:[(0,s.jsx)(T,{loading:W||!ea,visibleResultCount:eF.length,truncated:!!eL}),eL&&!M&&(0,s.jsxs)(s.Fragment,{children:["\xa0",(0,s.jsx)(v.A,{id:"see-all-results-link",className:(0,S.$)("focus-visible",{"FileResultsList-module__PrimerLink__Ef_8NuZ":ef&&ec===eF.length}),ref:eh,href:(0,c.Y8Y)({owner:B.ownerLogin,repo:B.name,searchTerm:`path:${es}`}),children:"See all results"})]})]})]})});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E.az,{ref:e_,sx:q,className:I,children:(0,s.jsx)(j.Z,{ariaActiveDescendant:(!ev&&O||ev&&P)&&ef&&ec>-1?eL&&ec===eF.length?"see-all-results-link":`file-result-${ec}`:void 0,ariaExpanded:ev?P:void 0,ariaHasPopup:ev,ariaControls:ev?eg:void 0,ref:G,query:O,onKeyDown:e=>{let{key:l,shiftKey:t,metaKey:s,altKey:r,ctrlKey:i}=e;if(!t&&!s&&!r){if("Escape"===l)O?(ex("FILE_TREE.CANCEL_SEARCH"),Z(""),en()):document.activeElement&&document.activeElement.blur();else if(!O)return;else if("Enter"===l){if(!M&&eL&&ec===eF.length)eu((0,c.Y8Y)({owner:B.ownerLogin,repo:B.name,searchTerm:`path:${es}`})),L?.();else if(eF[ec]){let e=eF[ec];eu(eb(eF[ec],!1,er?`L${er}`:"")),U(!1),L?.(e)}}else if("ArrowDown"===l||i&&"n"===l){if(!M&&eL&&ec>=eF.length-1){if(ed(eF.length),eh.current&&eE.current){let e=(0,u.U)(eE.current);(0,h.Rt)(eh.current,e,{behavior:"instant"})}}else ed(Math.min(ec+1,eF.length-1));e.preventDefault();return}else if("ArrowUp"===l||i&&"p"===l){ed(Math.max(ec-1,0)),e.preventDefault();return}}},onPreload:()=>V(!0),onSearch:e=>{Z(e),e?U(!0):(en(),U(!1)),ed(0)},onBlur:e=>{eE.current?.contains(e.relatedTarget)||(U(!1),em(!1))},onFocus:()=>{O&&U(!0),em(!0)},className:"FileResultsList-module__FilesSearchBox__VEX5_qz"})}),ev&&(0,s.jsx)(R.T,{anchorRef:e_,open:ev&&P,renderAnchor:null,onClose:()=>{U(!1)},focusZoneSettings:{disabled:!0},focusTrapSettings:{disabled:!0},width:"xlarge",align:"end",overlayProps:{id:eg,role:"dialog"},children:ey}),!ev&&O&&ey]})}function T({visibleResultCount:e,truncated:l,loading:t}){return(0,s.jsx)("span",{role:"status",className:t||l||0===e?void 0:"sr-only","aria-label":t?"Loading":void 0,children:t?(0,s.jsx)(b.A,{size:"large"}):0===e?"No matches found":l?`First ${e} files shown.`:`Showing ${e} files.`},"results-count-status")}k.displayName="FileResultsList",T.displayName="FileResultsStatus";let I=({active:e,focused:l,index:t,match:r,query:i,to:a,isDirectory:n,onClick:o,onRender:c,useOverlay:f,listRef:m})=>{let _=(0,L.Xq)(i,r);c?.();let g=y.useRef(null),x=n?q:$;y.useEffect(()=>{if(l&&g.current&&m?.current){let e=(0,u.U)(m.current);(0,h.Rt)(g.current,e,{behavior:"instant"})}},[l,m]);let v=(0,y.useCallback)(()=>{o?.(r)},[r,o]);return(0,s.jsx)(p.l.Item,{role:"group",active:e,className:(0,S.$)(l?"FileResultsList-module__ActionList_ItemFocused__qZOsnRq":void 0),children:(0,s.jsxs)(d.N,{to:a,ref:g,role:"option",onClick:v,id:`file-result-${t}`,tabIndex:f?-1:0,"data-focus-visible-added":l||void 0,className:(0,S.$)("d-flex","FileResultsList-module__ActionList_Item__vKArz0Z"),children:[(0,s.jsx)("div",{className:"d-flex flex-1 flex-column overflow-hidden",children:(0,s.jsx)(z,{text:r,positionsList:_,LeadingIcon:x,className:"FileResultsList-module__HighlightMatch__icSzY8j"})}),l&&(0,s.jsx)("div",{className:"sr-only",children:`Go to ${n?"folder":"file"}`})]})},r)};I.displayName="FileResultRow";let q=()=>(0,s.jsx)(F.A,{"aria-label":"Directory",icon:_.FileDirectoryFillIcon,size:"small",className:"FileResultsList-module__Octicon__BcKI1HC"});q.displayName="DirectoryIcon";let $=()=>(0,s.jsx)(F.A,{"aria-label":"File",icon:_.FileIcon,className:"fgColor-muted mr-2",size:"small"});$.displayName="FileResultIcon";let D=y.memo(I);function z({text:e,positionsList:l,className:t,LeadingIcon:r}){let i=[],a=0;for(let t of l){if(Number(t)!==t||t<a||t>e.length)continue;let l=e.slice(a,t);l&&i.push(H(l)),a=t+1,i.push((0,s.jsx)("mark",{className:"text-bold bgColor-transparent fgColor-default",children:e[t]},t))}return i.push(H(e.slice(a))),(0,s.jsx)("div",{className:t,children:(0,s.jsxs)(s.Fragment,{children:[r&&(0,s.jsx)(r,{}),i]})})}function H(e){return e.replaceAll("/","/\u200B")}D.displayName="MemoizedFileResultRow",z.displayName="HighlightMatch"},47698(e,l,t){t.d(l,{Z:()=>m,q:()=>h});var s=t(74848),r=t(70170),i=t(64278),a=t(77277),n=t(95066),o=t(23131),u=t(38621),c=t(94709),d=t(96540),f=t(34164);let m=({ref:e,ariaActiveDescendant:l,ariaControls:t,ariaExpanded:n,ariaHasPopup:m,onBlur:_,onFocus:g,onKeyDown:x,onPreload:p,onSearch:v,query:R,sx:b,className:E})=>{let{sendRepoClickEvent:F}=(0,a.T)(),[L,y]=d.useState(R),N=(0,o.G7)("file_finder_skip_debounce"),C=d.useRef((0,r.s)(e=>v(e),250));d.useEffect(()=>{y(R)},[R]);let j=R?(0,s.jsx)(c.ks.Action,{onClick:()=>{F("FILE_TREE.CANCEL_SEARCH"),v("")},icon:u.XCircleFillIcon,"aria-label":"Clear",className:"fgColor-muted"}):void 0;return(0,s.jsx)(c.ks,{autoFocus:h(),ref:e,value:L,onKeyDown:x,onChange:e=>{y(e.target.value),p(),N?v(e.target.value):C.current(e.target.value)},sx:b,className:(0,f.$)("d-flex",E),"aria-label":"Go to file","aria-activedescendant":l,role:m?"combobox":void 0,"aria-controls":t,"aria-expanded":n,"aria-haspopup":m?"dialog":void 0,autoCorrect:"off",spellCheck:"false",placeholder:"Go to file",leadingVisual:u.SearchIcon,trailingAction:j,trailingVisual:j?void 0:()=>(0,s.jsx)(i.E,{children:(0,s.jsx)("kbd",{children:"t"})}),onFocus:e=>{p(),e.target.select(),g?.(e)},onBlur:_,onClick:()=>F("FILE_TREE.SEARCH_BOX")})};function h(){return"1"===new URLSearchParams(n.fV.search).get("search")}m.displayName="FilesSearchBox",m.displayName="FilesSearchBox"}}]);
//# sourceMappingURL=67894-3c69c611a4c4556a-58bbcbc4ac1f40bf.js.map